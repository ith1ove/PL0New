# EX09 测试说明

## 测试目的
验证 PL0 编译器中 += 和 -= 复合赋值运算符的正确实现。

## 测试内容

### 1. 基本 += 运算测试
- `a := 10; a += 5;` 应该输出 15
- `a += 10;` 应该输出 25

### 2. 基本 -= 运算测试  
- `b := 30; b -= 8;` 应该输出 22
- `b -= 12;` 应该输出 10

### 3. 复合表达式测试
- `c += a + b;` 测试右侧为表达式的情况
- `c -= a - b;` 测试右侧为减法表达式的情况

### 4. 连续运算测试
- 连续使用 += 和 -= 运算符的组合测试

### 5. 与其他运算符结合测试
- `a += b * 3;` 测试与乘法运算的结合
- `b -= a / 2;` 测试与除法运算的结合

## 预期输出序列
```
10    // a 的初始值
15    // a += 5 后的值
25    // a += 10 后的值
30    // b 的初始值
22    // b -= 8 后的值
10    // b -= 12 后的值
40    // c += (a + b) 后的值
25    // c -= (a - b) 后的值
100   // result 经过多次运算后的值
7     // a += b * 3 后的值
-1    // b -= a / 2 后的值
```

## 生成的 P-Code 示例
对于 `a += 5` 语句，应该生成：
```
LOD L A    // 加载变量 a 的值
LIT 0 5    // 加载常量 5
OPR 0 2    // 执行加法运算
STO L A    // 存储结果到变量 a
```

对于 `b -= 8` 语句，应该生成：
```
LOD L A    // 加载变量 b 的值
LIT 0 8    // 加载常量 8
OPR 0 3    // 执行减法运算
STO L A    // 存储结果到变量 b
```

## 测试验证要点
1. 词法分析正确识别 += 和 -= 运算符
2. 语法分析正确处理复合赋值语句
3. 语义分析正确生成对应的 P-Code 指令
4. 运行时正确执行复合赋值操作
5. 支持右侧为复杂表达式的情况
6. 错误处理：对常量使用复合赋值应该报错

## 实现原理
- `var += expr` 等价于 `var := var + expr`
- `var -= expr` 等价于 `var := var - expr`
- 编译器先加载变量当前值，然后计算右侧表达式，执行运算，最后存储结果
